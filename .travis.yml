if: branch = master
language: go
go:
  - 1.13.x

script:
  - export GO111MODULE=on
  - GOOS=linux GOARCH=amd64 go build -o kdt
  - sha256sum kdt > kdt.sha256 
  - GOOS=windows GOARCH=amd64 go build -o kdt.exe
  - sha256sum kdt.exe > kdt.exe.sha256

deploy:
    provider: releases
    api_key:
      secure: $GITHUB_TOKEN
    file:
      - kdt
      - kdt.sha256
      - kdt.exe
      - kdt.exe.sha256
    skip_cleanup: true
    on:
      tags: true
